# direnv configuration for Netresearch TimeTracker

# Load local environment if present
dotenv_if_exists .env
dotenv_if_exists .env.local

# Helpful environment
export TIMETRACKER_NAME="Netresearch TimeTracker"
export TIMETRACKER_PORT="8765"
export TIMETRACKER_URL="http://localhost:${TIMETRACKER_PORT}"
export APP_ENV="${APP_ENV:-dev}"

# Add local bin to PATH if exists
PATH_add bin

tthelp() {
  cat <<'EOF'
Netresearch TimeTracker â€” developer help

URL: ${TIMETRACKER_URL}

Common make targets:
  make up              # start stack (nginx, app, db)
  make down            # stop stack
  make restart         # restart stack
  make build           # build images
  make logs            # follow logs
  make sh              # shell into app container (requires make up)

Dependencies & assets:
  make install         # composer install + npm install
  make composer-install|update
  make npm-build|dev|watch

Quality & tests:
  make test            # run test suite
  make coverage        # run tests with HTML coverage in var/coverage
  make stan            # PHPStan
  make psalm           # Psalm
  make cs-check        # PHP_CodeSniffer
  make cs-fix          # PHP-CS-Fixer
  make check-all       # stan + psalm + phpcs
  make fix-all         # psalm alter + php-cs-fixer + rector

Docs:
  Swagger UI: ${TIMETRACKER_URL}/docs/swagger/index.html
  README:     README.rst
  Dev docs:   docs/development.md

Tip: First time here? Run: direnv allow
EOF
}

# Print welcome/help when entering the directory
if [ -z "${TT_ENVRC_SHOWN:-}" ]; then
  export TT_ENVRC_SHOWN=1
  echo
  echo "[${TIMETRACKER_NAME}] ${TIMETRACKER_URL} (APP_ENV=${APP_ENV})"
  echo "Type 'tthelp' for developer commands."
  echo
fi


